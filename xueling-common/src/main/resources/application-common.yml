server:
  port: 9012


spring:
  ai:
    openai:
      api-key: ${DEEPSEEK_API_KEY}
      chat:
        base-url: "https://api.deepseek.com/"
        options:
          model: "deepseek-chat"
  http:
    client:
      connect-timeout: 600s #连接超时时间
      read-timeout: 600s #读取超时时间

  datasource:
    # 1. 基本连接信息
    type: com.alibaba.druid.pool.DruidDataSource
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/xueling_db?serverTimezone=Asia/Shanghai&useUnicode=true&characterEncoding=utf-8&allowMultiQueries=true
    username: ${mysql_username}
    password: ${mysql_password}

    # 2. Druid 核心配置
    druid:
      # 数据源基础配置
      initial-size: 5
      min-idle: 5
      max-active: 20
      # 监控页面配置（核心）
      stat-view-servlet:
        enabled: true
        url-pattern: /druid/*
        login-username: xgx
        login-password: xgx123
        reset-enable: false
      # web统计过滤器
      web-stat-filter:
        enabled: true
        url-pattern: /*
        exclusions: "*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*"
      # 开启监控过滤器
      filters: stat,wall,slf4j
      filter:
        stat:
          log-slow-sql: true
          slow-sql-millis: 2000

  #    # 2. Druid专有配置（核心：开启监控、配置连接池参数）
  #    druid:
  #      # 2.1 连接池配置（优化连接池性能）
  #      initial-size: 5                # 初始化连接数
  #      min-idle: 5                    # 最小空闲连接数
  #      max-active: 20                 # 最大活跃连接数
  #      max-wait: 60000                # 获取连接时的最大等待时间（毫秒）
  #      time-between-eviction-runs-millis: 60000  # 每隔60秒检查一次空闲连接
  #      min-evictable-idle-time-millis: 300000    # 连接空闲300秒后被驱逐
  #      validation-query: SELECT 1 FROM DUAL      # 连接有效性检查SQL
  #      test-while-idle: true          # 空闲时检查连接有效性
  #      test-on-borrow: false          # 借用连接时不检查（提高性能）
  #      test-on-return: false          # 返回连接时不检查（提高性能）
  #      pool-prepared-statements: true # 开启预编译语句池
  #      max-pool-prepared-statement-per-connection-size: 20 # 每个连接的预编译语句最大数量
  #
  #      # 2.2 监控配置（核心：开启stat过滤器、配置监控页面）
  #      filters: stat,wall,log4j2      # 启用的过滤器：stat（统计）、wall（SQL防火墙）、log4j2（日志）
  #      filter:
  #        stat:
  #          slow-sql-millis: 5000      # 慢查询阈值（超过5秒的SQL视为慢查询）
  #          log-slow-sql: true         # 记录慢查询日志
  #          merge-sql: true            # 合并相同SQL的统计结果
  #        wall:
  #          config:
  #            multi-statement-allow: true # 允许执行多语句SQL（与url中的allowMultiQueries=true对应）
  #
  #      # 2.3 Web监控配置（可选：开启Druid监控页面）
  #      web-stat-filter:
  #        enabled: true                # 开启Web应用监控
  #        url-pattern: /*              # 监控所有URL
  #        exclusions: "*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*" # 排除静态资源和Druid自身页面
  #      stat-view-servlet:
  #        enabled: true                # 开启Druid监控页面
  #        url-pattern: /druid/*        # 监控页面访问路径（访问http://localhost:端口/druid即可进入）
  #        reset-enable: false          # 禁用“重置统计”功能（防止误操作）
  #        login-username: admin        # 监控页面登录用户名（自定义）
  #        login-password: admin        # 监控页面登录密码（自定义）
  #        allow: 127.0.0.1             # 允许访问的IP（默认只允许本地）
  #        deny: 192.168.1.100          # 禁止访问的IP（可选）


  data:
    redis:
      database: 1
      host: localhost
      port: 6379
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
          max-wait: 100 # 连接等待时间（毫秒）
# Jackson配置
  jackson:
    default-property-inclusion: NON_NULL # 忽略NULL属性
    deserialization:
      fail-on-unknown-properties: false  # 忽略未知属性
      fail-on-ignored-properties: false
      fail-on-invalid-subtype: false
    # 序列化配置
    serialization:
      fail-on-empty-beans: false
      write-dates-as-timestamps: false
      write-date-timestamps-as-nanoseconds: false


#阿里云OSS配置
aliyun:
  oss:
    endpoint: https://oss-cn-hangzhou.aliyuncs.com
    accessKeyId: ${aliyun_oss_id}
    accessKeySecret: ${aliyun_oss_key}
    bucketName: xueling-platform

email:
  host: smtp.qq.com
  port: 465
  username: ${email_username}
  password: ${email_key}  # SMTP授权码


logging:
  level:
    root: INFO          # 全局默认INFO，不影响其他日志
    org.springframework.ai: DEBUG  # Spring AI 核心包强制DEBUG（关键）



llm:
  doubao:
    api-key: ${DOUBAO_API_KEY}
    url: "https://ark.cn-beijing.volces.com/api"
    model: "doubao-seed-1-6-flash-250828"  #(响应更快)
#    model: "doubao-seed-1-6-lite-251015"
  deepseek:
    api-key: ${DEEPSEEK_API_KEY}
    url: "https://api.deepseek.com/"
    chat-model: "deepseek-chat"
    reasoner-model: "deepseek-reasoner"
  zhipu:
    api-key: ${ZHIPU_API_KEY}
    url: "https://open.bigmodel.cn/api/paas/v4"
    image-model: "cogview-3-flash"

#线程池配置
thread-pool:
  config:
    core-pool-size: 5 # 核心线程数
    max-pool-size: 10 # 最大线程数
    queue-capacity: 100 # 队列容量
    thread-name-prefix: "My-Async-" # 线程前缀名
    keep-alive-seconds: 120 # 线程空闲时间

